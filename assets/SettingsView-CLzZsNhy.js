import{j as e,C as s,u as t,A as a,B as r,k as i,l,m as n,r as d}from"./index-D85gtc9V.js";import{r as c}from"./leaflet-QxLtkkBL.js";import"./react-Z2Iecplj.js";import"./genai-DmvHCT3V.js";const o=({checked:s,onChange:t,disabled:a=!1})=>e.jsx("button",{type:"button",className:(s?"bg-slate-800 dark:bg-sky-500":"bg-gray-200 dark:bg-slate-600")+" relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-slate-900",role:"switch","aria-checked":s,onClick:()=>!a&&t(!s),disabled:a,children:e.jsx("span",{"aria-hidden":"true",className:(s?"translate-x-5":"translate-x-0")+" pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"})}),m=({addToast:t})=>{const[a,o]=c.useState([]),[m,x]=c.useState(!1),u=c.useCallback(()=>{const e=i().map(l);o(e)},[]);c.useEffect(()=>{u();const e=setInterval(u,5e3);return()=>clearInterval(e)},[u]);return 0===a.length?null:e.jsxs(s,{children:[e.jsx("h3",{className:"font-bold text-lg text-destructive",children:"Offline Sync Issues"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"The following actions failed to sync with the server. You can retry them or discard them if they are no longer needed."}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:a.map(s=>e.jsxs("div",{className:"p-3 border rounded-md bg-destructive/5 dark:bg-destructive/10",children:[e.jsx("p",{className:"font-semibold break-all text-sm",children:s.summary}),e.jsx("p",{className:"text-sm text-destructive",children:s.error}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Failed at: ",s.timestamp]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx(r,{size:"sm",variant:"secondary",onClick:()=>{return e=s.id,n(e),t("Action discarded.","success"),void u();var e},disabled:m,children:"Discard"}),e.jsx(r,{size:"sm",variant:"primary",onClick:()=>(async e=>{x(!0);try{await d(e),t("Retrying action...","success")}catch(s){t("Retry failed immediately.","error")}u(),x(!1)})(s.id),isLoading:m,children:"Retry"})]})]},s.id))})]})},x=({user:i,addToast:l})=>{const{updateUserProfile:n}=t(),[d,o]=c.useState({firstName:i.firstName,lastName:i.lastName,phone:i.phone||"",avatar:i.avatar||""}),[m,x]=c.useState(!1),[u,h]=c.useState({});c.useEffect(()=>{o({firstName:i.firstName,lastName:i.lastName,phone:i.phone||"",avatar:i.avatar||""})},[i]);const p=(e,s)=>{o(t=>({...t,[e]:s})),u[e]&&h(s=>{const t={...s};return delete t[e],t})};return e.jsxs(s,{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"My Profile"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return d.firstName.trim()||(e.firstName="First name is required."),d.lastName.trim()||(e.lastName="Last name is required."),h(e),0===Object.keys(e).length})()){x(!0);try{await n({id:i.id,...d}),l("Profile updated successfully!","success")}catch(s){l(s instanceof Error?s.message:"Failed to update profile.","error")}finally{x(!1)}}else l("Please correct the errors before saving.","error")},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(a,{name:`${d.firstName} ${d.lastName}`,imageUrl:d.avatar,className:"w-24 h-24 text-3xl"}),e.jsxs("div",{children:[e.jsx(r,{type:"button",variant:"secondary",onClick:()=>{const e=Math.floor(100*Math.random()),s=`https://i.pravatar.cc/150?u=${i.id}-${e}`;o(e=>({...e,avatar:s})),l("Profile picture updated. Save changes to confirm.","success")},children:"Upload Photo"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Recommended: Square image, 200x200px"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"First Name"}),e.jsx("input",{value:d.firstName,onChange:e=>p("firstName",e.target.value),className:"w-full p-2 border rounded "+(u.firstName?"border-destructive":"border-border")}),u.firstName&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:u.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Last Name"}),e.jsx("input",{value:d.lastName,onChange:e=>p("lastName",e.target.value),className:"w-full p-2 border rounded "+(u.lastName?"border-destructive":"border-border")}),u.lastName&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:u.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"p-2 ",children:i.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Phone"}),e.jsx("input",{type:"tel",value:d.phone,onChange:e=>p("phone",e.target.value),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx("p",{className:"p-2 capitalize",children:i.role.replace(/_/g," ").toLowerCase()})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(r,{type:"submit",isLoading:m,children:"Save Changes"})})]})]})},u=({settings:t,onSettingsUpdate:a})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs(s,{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Appearance"}),e.jsx("div",{className:"mt-4 space-y-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"theme",children:"Theme"}),e.jsxs("select",{id:"theme",value:t.theme,onChange:e=>{return s="theme",r=e.target.value,void(t&&t[s]!==r&&a({[s]:r}));var s,r},className:"p-2 border rounded bg-card",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"})]})]})})]}),e.jsxs(s,{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Accessibility"}),e.jsx("div",{className:"mt-4 space-y-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{children:[e.jsx("p",{children:"High Contrast Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Increases text and UI element contrast."})]}),e.jsx(o,{checked:t.accessibility.highContrast,onChange:e=>{return s="highContrast",r=e,void(t&&t.accessibility&&t.accessibility[s]!==r&&a({accessibility:{...t.accessibility,[s]:r}}));var s,r}})]})})]})]}),h=({user:t,addToast:a,settings:r,onSettingsUpdate:i})=>{const[l,n]=c.useState("profile");return r?e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-foreground",children:"Settings"}),e.jsx("div",{className:"border-b border-border",children:e.jsxs("nav",{className:"-mb-px flex space-x-6",children:[e.jsx("button",{onClick:()=>n("profile"),className:"whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm "+("profile"===l?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:"My Profile"}),e.jsx("button",{onClick:()=>n("company"),className:"whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm "+("company"===l?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:"Company"})]})}),"profile"===l&&e.jsx(x,{user:t,addToast:a}),"company"===l&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{settings:r,onSettingsUpdate:i}),e.jsx(m,{addToast:a})]})]}):e.jsx(s,{children:e.jsx("p",{children:"Loading settings..."})})};export{h as SettingsView};
